import{b,h as m,$ as o,i as s,f as p,d as u,k as v,l as w}from"./utils.DM-uB-iw.js";import{c as P}from"./index.DjLv4mDk.js";function E(){const t=localStorage.getItem("discount_percent");if(t){const e=Number(t);if(!isNaN(e))return e}return 0}const f=b.get("discount_code");m.set(f?{code:f,percent:E()}:null);const L=300,y=o("cart"),n=o("cart-backdrop");n.addEventListener("click",()=>{s.set(!1)});window.addEventListener("keydown",t=>{t.key==="Escape"&&s.set(!1)});let r;s.listen(t=>{if(r&&clearTimeout(r),t){y.style.transform="translateX(-100%)",n.style.display="block",n.style.opacity="1";const e=window.innerWidth-document.body.clientWidth;document.body.style.overflow="hidden",document.body.style.paddingRight=`${e}px`}else y.style.removeProperty("transform"),n.style.opacity="0",r=setTimeout(()=>{n.style.display="none",document.body.style.removeProperty("overflow"),document.body.style.removeProperty("padding-right")},L)});o("cart-close").addEventListener("click",()=>{s.set(!1)});const d=o("cart-subtotal"),g=o("cart-discount"),c=o("cart-checkout");let k=!1;const h=["bg-[repeating-linear-gradient(135deg,transparent_0%,transparent_48%,white_50%,transparent_52%,transparent_100%)]","text-neutral-400"];P([u,m],(t,e)=>[t,e]).subscribe(([t,e])=>{d.textContent=p(t?.salesPrice??0);const i=t?.salesPrice?t.salesPrice.value===0:!0;e&&!i?(d.classList.add(...h),g.textContent=p(t?.salesPrice??0,{discount:e.percent/100})):(d.classList.remove(...h),g.textContent=""),c.disabled=k||!t?.items.length});c.addEventListener("click",async()=>{let t=u.get();if(!t)return;k=!0,c.textContent="Checking out...",c.disabled=!0,t.$o&&(t=await new Promise(i=>{u.listen(a=>{a&&!a.$o&&i(a)})}));const e=await v(t.id,m.get()?.code);location.href=`https://${w}/checkout/${e.id}`});window.location.hash==="#cart"&&s.set(!0);const l=document.getElementById("menu-toggle");document.addEventListener("click",t=>{l.checked&&l!==t.target&&(l.checked=!1)});const C=o("c");C.addEventListener("click",()=>{s.set(!0)});
